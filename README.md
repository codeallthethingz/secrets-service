# Secrets Service

[![Go Report Card](https://goreportcard.com/badge/github.com/codeallthethingz/secrets-service)](https://goreportcard.com/report/github.com/codeallthethingz/secrets-service)
[![codecov](https://codecov.io/gh/codeallthethingz/secrets-service/branch/master/graph/badge.svg)](https://codecov.io/gh/codeallthethingz/secrets-service) 

Serverless function stub to serve secrets using the https://github.com/codeallthethingz/secrets file format.  Use the CLI tool to create a secrets file that is then used by this service.

Also includes a client library `SecretsClient` to interact with the service that you can import into calling code.

## Prerequisites

node / npm.

## Install

```bash
npm install -g now
git clone git@github.com:codeallthethingz/secrets
now
```

## Endpoint Usage

### POST `https://<your now service url>/`

Headers
```
"Authorization: <token>"
```
Body
```json
{ 
  "name": "secret name"
}
```

Response
```json
{ 
  "name": "secret name",
  "secret": "secret bytes"
}
```

Curl example
```bash
curl -H "Authorization: <token>" -d "{\"Name\": \"secretname\"}" https://<your now service url>/
```

## Client Usage

Use the client to query the endpoint.

```go
URL := "https://<your now service url>/"
auth := "<token>" // generated by the secrets CLI tool when you added a service.
secretsClient := NewSecretsClient(URL, auth)
secretBytes, err := secretsClient.Get("secretname")
if err != nil {
  t.Fatal(err)
}
// .. do something with your secret.
```